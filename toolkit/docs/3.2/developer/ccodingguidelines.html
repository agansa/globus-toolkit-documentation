<?php

$title = "Globus Toolkit 3.2: Developer's Guide";

include_once( "/mcs/www-unix.globus.org/include/globus_header.inc" ); 
?><p class="small"><a href="http://www.globus.org">Globus</a> &gt;

<a href="http://www-unix.globus.org/toolkit/">Toolkit</a> &gt;

<a href="http://www-unix.globus.org/toolkit/docs/">Documentation</a> &gt; <a href="../../index.html">3.2</a> &gt; Developer's
Guide
&lt; </p>

<h1>Globus Toolkit 3.2: Developer's Guide </h1>
<p class="small">&gt;Overview<br>
    <a href="apis.html">API</a><br>
    <a href="codingguidelines.html">Coding Guidelines</a> &gt; C &lt; <br>
  Best Practices (coming soon)<br>
  Porting Guide (coming soon)<br>
  <a href="samples.html">Samples</a> <br>
  <a href="thirdpartysupport.html">Third Party Support</a> </p>
<h2>C Coding Guidelines</h2>
<p>In an attempt to increase code readability and  productivity, the
  Globus Alliance requests that all programmers follow the standard defined below
  for programming in C. </p>
<ul>
  <li>  <a href="#Code Block Style">Code Block Style</a></li>
  <li>  <a href="#Variable Declarations">Variable Declarations</a></li>
  <li>  <a href="#Function Definitions">Function Definitions</a></li>
  <li>  <a href="#Typedefs and Structures">Typedefs and Structures</a></li>
  <li>  <a href="#Mainpage and Group Documentation">Mainpage and Group Documentation</a></li>
  <li>  <a href="#Preprocessor Directives">Preprocessor Directives</a></li>
  <li>  <a href="#Miscellaneous">Miscellaneous</a> </li>
</ul>
<h3><a name="Code Block Style"></a>Code
Block Style</h3>
<ul>
  <li>Opening
      braces should be placed on a line by themselves and indented to the same
      column as the previous statement.&nbsp; Closing braces should also be placed
      on a line by themselves and indented to the same column as the matching
      opening brace.<br>
  </li>
  <li>The beginning
      of each statement should be indented four spaces more than the previous
      open brace.<br>
  </li>
  <li>Line
      length should be restricted to 80 columns.<br>
  </li>
  <li>Continuation
      lines should be indented to the column just beyond the previous open parenthesis.&nbsp; If
      no open parenthesis exists, the line should be indent two spaces more than
      the start of the statement.<br>
  </li>
  <li>Labels
      should be indented two spaces less than surrounding statements.</li>
</ul>
<h3><a name="Variable Declarations"></a>Variable
Declarations</h3>
<p>Variables should be declared using the follow format:<br>
</p>
<pre class="command">[/* comment for one or more related variables;     comments that
 &nbsp;&nbsp;&nbsp; overflow a single should be left justified with the start
 &nbsp;&nbsp;&nbsp; of the comment text */]
 &lt;type&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;var name&gt;;</pre>
<p>  <br>
  Each variable declaration should appear on its own line, and all variable names
  and comments should be aligned.&nbsp; If the variable being declared is a pointer,
  the asterisk(s) should be placed with the &lt;type&gt; rather
  than with the &lt;var name&gt;. <br>
      <br>
  In general, variables should declared such that their scope is minimized.&nbsp; Global
  and module specific (static)
  variables should be avoided whenever possible.&nbsp; If data needs to be shared
  across functions (and handlers), space for it should be allocated on the heap
  and registered as thread specific data. This helps avoid common multithreading
  bugs.&nbsp; In the case of data being shared between a handler and a function
  which initiated that handler (either directly or indirectly) and is now waiting
  for that handler to complete, the function may allocate space for the data
  on the current thread's stack prior to initiating the send_rsr.&nbsp; It
  is however essential that the handler desist from accessing those data after
  the function returns.<br>
      <br>
  If necessary, module specific and global variables may be created.&nbsp; Module
  specific variables should declared at the top of the  globus_&lt;package&gt;_&lt;module&gt;.c  file. &nbsp; Global
  variables, like module specific variables, should be declared at the top code
  file, but should also be declared external (extern)
  in the  globus_&lt;package&gt;_&lt;module&gt;.h  file.<br>
      <br>
  Data items (variables or fields) which are passed between threads, such
  as flags and data fields associated a monitor, may need to be declared
  as  volatile.&nbsp; Declaring
  items this way prevents the compiler from caching values in registers and thus
  using potentially stale data.&nbsp; Unfortunately, the definition of volatile
  depends on the compiler being used.&nbsp; In general, it is a good idea to
  declare a data item as  volatile  if
  the data item is touched before a synchronization point and referenced after
  a synchronization point during which another thread may have modified the data.&nbsp; More
  details will be provide about this later...<br>
      <br>
Variable names should follow a format of:
<pre class="command">globus{,_i,_l}_&lt;package&gt;[_&lt;module&gt;]_&lt;subject&gt;</pre>

  <p> thus disclosing the hierarchy to which the variable belongs, while also
  avoiding symbol name space pollution (i.e., all global symbols are named globus_*).&nbsp; In
    two cases, the name should be augmented with an 'i'
    or an 'l'
    (ell):
  </p>
<ul>
  <li>Variables
      which are for internal development use only, but which are symbols in the
      global namespace, should have an 'i'
      prepended to the package name.</li>
  <li>Variables
      which are module specific (local, file static variables) should have an
      'l'
      prepended to the package name.</li>
</ul>
<h3><a name="Function Definitions"></a>Function
Definitions</h3>
<p>All functions should be specified using the following format:</p>
<pre class="command">  /**
 &nbsp;* &lt;brief descriptive sentence&gt;
 &nbsp;* &lt;longer description of function&gt;
 &nbsp;*
 &nbsp;* @ingroup &lt;globus_&lt;package&gt;_&lt;module&gt;_&lt;doxygen group&gt;&gt;
 &nbsp;*
 &nbsp;*&nbsp;@param &lt;param1&gt;
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;description of param1 with each line of the
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description indented to line up with param1&gt;
 &nbsp;*&nbsp;...
 &nbsp;*&nbsp;@param &lt;paramN&gt;
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;description of paramN&gt;
 &nbsp;*
 &nbsp;*&nbsp;@retval &lt;value1&gt;
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;description of return value value1&gt;
 &nbsp;* ...
 &nbsp;* @retval &lt;valueN&gt;
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;description of return value valueN&gt;
 &nbsp;*/
 [static]
 &lt;return type&gt;
 &lt;function name&gt;(
 &nbsp;&nbsp;&nbsp; &lt;type1&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;param1&gt;,
 &nbsp;&nbsp;&nbsp; &lt;type2&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;param2&gt;,
 &nbsp;&nbsp;&nbsp; ...
 &nbsp;&nbsp;&nbsp; &lt;typeN&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;paramN&gt;)
 {
 &nbsp;&nbsp;&nbsp; &lt;code block(s)&gt;
 }
 /* &lt;function name&gt;() */</pre>
<p>  To elaborate, this means that the type of the value returned by this function
should be placed on a separate line from the function name.&nbsp; Additionally,
each parameter declaration should be listed on a separate line and indented to
column 4.&nbsp; In addition, the parameter names should be aligned at a standard
tab stop, preferably columns 40.&nbsp; Function names should follow a format
of</p>
<pre class="command">globus{_i,_l}_&lt;package&gt;[_&lt;module&gt;]_&lt;subject&gt;_&lt;action&gt;</pre>
<p>thus disclosing
    the hierarchy to which the function belongs.&nbsp; In two cases, the package
    field should be augmented with an 'i'
    or an 'l'.&nbsp; Functions
    which are for internal development use only should have an 'i'
    prepended to the package name.&nbsp; Functions which are module specific
    (local) should have an 'l'
prepended to the package name.</p>
<p>The documentation
    comments for a function should reference a group id with an  @ingroup  tag.&nbsp; To
    define a group that we refer to here, see the <a href="#Mainpage and Group Documentation">section
    below</a>.&nbsp;</p>
<p>Here's an
example:
<pre class="command">  /**
 &nbsp;* Cancel a particular job.
 &nbsp;* This function removes a PENDING job request or kills
 &nbsp;* all processes associated with an ACTIVE job.
 &nbsp;*&nbsp;
 &nbsp;* @ingroup globus_gram_client_job
 &nbsp;*
 &nbsp;*&nbsp;@param job_contact
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; identifier of the job
 &nbsp;*
 &nbsp;*&nbsp;@retval GLOBUS_SUCCESS
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the operation completed successfully 
 &nbsp;* @retval GLOBUS_GRAM_CLIENT_ERROR_*
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; an error occured
 &nbsp;*
 &nbsp;* @see globus_gram_client_job_request()
 &nbsp;*/
 int
 globus_gram_client_job_cancel(
 &nbsp;&nbsp;&nbsp; char * &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;job_contact)
 {
 &nbsp;&nbsp;&nbsp; /* a set of related variables used for some purpose */
 &nbsp;&nbsp;&nbsp; int * &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable1;
 &nbsp;&nbsp;&nbsp; globus_bool_t &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable2;
   
 &nbsp;&nbsp;&nbsp; /* another variable for some other purpose */
 &nbsp;&nbsp;&nbsp; float &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable3;
   
 &nbsp;&nbsp;&nbsp; /*
 &nbsp;&nbsp;&nbsp;&nbsp; * Function body goes here
 &nbsp;&nbsp;&nbsp;&nbsp; */
   
 &nbsp;&nbsp;&nbsp; return(GLOBUS_SUCCESS);
 }
 /* globus_gram_client_job_cancel() */</pre>
<p><br>
  Functions should be declared as module specific (with a type of static)
  whenever possible. Module specific functions should have a prototype declaration
  registered at the top of the module's code file. Functions which are part of
  an end-user API must be declared in an installable header file (globus_&lt;package&gt;_&lt;module&gt;.h).
  All other functions should be declared in an internal header file (globus_i_&lt;package&gt;_&lt;module&gt;.h).
<h3><a name="Typedefs and Structures"></a>Typedefs
and Structures</h3>
<p>Typedefs
and structures should follow the same symbol naming conventions as variables
and functions, with that addition that all structure names should be appended
with &quot;_s&quot;,
and all typedefs should be appended with &quot;_t&quot;:
<pre class="command">globus{_i,_l}_&lt;package&gt;[_&lt;module&gt;]_&lt;subject&gt;_{s,t}</pre>
<p>  The documentation comments for a structure&nbsp; should reference a group id
with an  @ingroup tag.&nbsp; To
define a group that we refer to here, see the <a href="#Mainpage and Group Documentation">section
below</a>.&nbsp;
<p>For example:
<pre class="command">  /**
 &nbsp;* @struct globus_gram_client_list_t
 &nbsp;*
 &nbsp;* Brief structure definition.
 &nbsp;* Long structure description that talks about how
 &nbsp;* this is used, possibly including references to
 &nbsp;* other related stuff.
 &nbsp;*
 &nbsp;* @ingroup &lt;globus_&lt;package&gt;_&lt;module&gt;_&lt;doxygen group&gt;&gt;
 &nbsp;*
 &nbsp;* [@see globus_gram_client_list_add_member()]
 &nbsp;*/
 typedef struct globus_gram_client_list_s
 {
 &nbsp;&nbsp;&nbsp; void * &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value;
 &nbsp;&nbsp;&nbsp; struct globus_gram_client_list_s * &nbsp;next;
 }
 globus_gram_client_list_t;</pre>
<h3><a name="Preprocessor Directives"></a>Preprocessor
Directives</h3>
<p>Some compiler implementers have interpreted the ANSI standards as requiring a  #  preprocessing
token as the first character of a line of a preprocessor directive.&nbsp; For
this reason it's recommended that if you want to include indentation in preprocessor
directives that you do so between  #  and
the keyword token.&nbsp; </p>
<p>For example: </p>
<pre class="command">#ifdef USE_TRACEPOINT
   #&nbsp;&nbsp;&nbsp; include &quot;tracepoint.h&quot;
   #else
   #&nbsp;&nbsp;&nbsp; define tracepoint(str)
 #endif</pre>
<h3><a name="Mainpage and Group Documentation"></a>Mainpage
and Group Documentation</h3>
<p>Include a long description for each Globus module in the main header file of
a Globus module.&nbsp; 
<p>As an example, the long description (or mainpage)
    should look something like:
<pre class="command">/**
 &nbsp;* @mainpage
 &nbsp;*
 &nbsp;* The Globus Replica Catalog C API provides operations
 &nbsp;* to manage the information in a replica catalog.
 &nbsp;* There are functions and structures for
 &nbsp;* @link globus_replica_catalog_connection
 &nbsp;* managing connections @endlink
 &nbsp;* to a collection in a replica catalog, as well as for
 &nbsp;* managing
 &nbsp;* @link globus_replica_catalog_collection
 &nbsp;* collection @endlink,
 &nbsp;* @link globus_replica_catalog_location
 &nbsp;* location @endlink, and
 &nbsp;* @link globus_replica_catalog_logicalfile
 &nbsp;* logical file @endlink
 &nbsp;* information. Each of these last three contain
 &nbsp;* functions that add, delete, and query their respective
 &nbsp;* information.
 &nbsp;*
 &nbsp;* At a high level, a @e replica @e catalog maps logical
 &nbsp;* filenames to physical locations...
 &nbsp;*/</pre>
<p>Also, include
    at least one Doxygen group definition block for each logical grouping of
    functions and structures within a Globus module.&nbsp; It should have an id,
    title, and description of the form:</p>
<pre class="command">/**
 &nbsp;* @defgroup &lt;id&gt; &lt;title&gt;
 &nbsp;* &lt;brief descriptive sentence&gt;
 &nbsp;* &lt;longer group description&gt;
 &nbsp;*/</pre>
<p>The  id  is
    used to reference this group and should have the form:</p>
<pre class="command"> globus_&lt;package&gt;_&lt;module&gt;_&lt;doxygen     group&gt;</pre>
<p> A
    reference to a group should be included in every function and structure documentation
    comment (with @ingroup &lt;id&gt;).&nbsp; </p>
<p>As
      an example, a group definition should look something like:</p>
<pre class="command">/**
 &nbsp;* @defgroup globus_replica_catalog_connection Connection Management
 &nbsp;*
 &nbsp;* Manage a connection to a collection in a replica catalog.
 &nbsp;*
 &nbsp;* As an example let's configure and open a connection:
 &nbsp;* @code
 &nbsp;* globus_replica_catalog_handleattr_t handleattr;
 &nbsp;* globus_replica_catalog_handle_t handle;
 &nbsp;* globus_replica_catalog_handleattr_init(&amp;handle);
 &nbsp;* globus_replica_catalog_handleattr_set_auth_mode(
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp; &amp;handleattr,
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp; GLOBUS_REPLICA_CATALOG_AUTH_MODE_CLEARTEXT,
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp; directory_manager_dn,
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp; directory_manager_passwd);
 &nbsp;* globus_replica_catalog_open(
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp; &amp;handle,
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp; &amp;handleattr,
 &nbsp;*&nbsp;&nbsp;&nbsp;&nbsp; ldap_contact_url);
 &nbsp;* @endcode
 &nbsp;*/</pre>
<p>(The above
    example uses abbreviated function names that don't necessarily reflect actual
    Globus function names.)</p>
<p>See the <a href="http://www.stack.nl/~dimitri/doxygen/">Doxygen
      site</a> for more information about how to use tags (@commands)
      in your documentation comments.&nbsp;</p>
<h3><a name="Miscellaneous"></a>Miscellaneous</h3>
<p>Do <strong>not</strong> abbreviate.&nbsp; Abbreviations may be convenient
  for you, and you may know what the abbreviation stands for.&nbsp; However,
  they may not be obvious to others, which will hinder the maintainability of
  the code.
<p>

<?php include("http://www-unix.globus.org/include/globus_footer.inc"); ?>
