<?php 
$title="GT 4.0 : System Administrator's Guide";
include_once( "/mcs/www-unix.globus.org/include/globus_header.inc" ); ?>

<?php
include_once( "http://www-unix.globus.org/toolkit/docs/development/4.0-drafts/draft.inc" );
?>



<h1><?php echo $title; ?></h1>
<ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#beforeyoubegin">Before you begin</a></li>
  <li><a href="#supportsoftware">Software Prerequisites </a>
      <ul>
        <li><a href="#reqsoftware">Required software</a></li>
        <li><a href="#optsoftware">Optional software</a></li>
        <li><a href="#platformnotes">Platform notes </a></li>
      </ul>
  </li>
  <li> <a href="#installinggt">Installing GT 4.0 </a></li>
  <li><a href="#configuring">Basic configuration </a>
      <ul>
        <li> Set environment variables</li>
        <li><span class="box-header"> Obtain host certificates</span></li>
        <li><span class="box-header"> Make the host credentials accessible
            by the container</span></li>
        <li><span class="box-header"> Add authorization </span></li>
        <li><span class="box-header"> Start the container </span></li>
        <li> Verify the basic installation </li>
        <li> Figure out where to go from here</li>
      </ul>
  </li>
  <li><a href="#maintenance">Maintaining your installation</a> </li>
  <li><a href="#troubleshooting">Troubleshooting</a></li>
  <li><a href="#relateddocs">Related documents</a></li>
</ul>
<h2><a name="introduction"></a>1 Introduction</h2>
<p>This guide is the starting point for everyone who wants to install Globus
  Toolkit 4.0. It will take you through a basic installation that installs Java
  WS Core and the following Base Services: a security infrastructure (GSI), the
  index service, and GridFTP. </p>
<p>Once you have this basic setup, you'll be referred to the component of your
  choice for any further installation and configuration information specific
  to that component.</p>
<p><strong>Important:</strong> We highly recommend that you fully read through
  this installation guide, then the <a href="#relateddocs">system administrator's
  guide of the component of your choice</a> before attempting the installation.</p>
<h2><a name="beforeyoubegin"></a>2 Before you begin</h2>
<p> Before you start installing the Globus Toolkit 4.0, there are a few things
  you should consider. The toolkit contains many subcomponents, and you may only
  be interested in some of them. </p>
<p> There are non-webservices implementations of Security, GridFTP, Resource
  Management (GRAM), Replica Location Service, and Information Services (MDS2).
  These all run on Unix platforms only. </p>
<p> Additionally, there are WSRF implementations of Security, Resource Management
  (GRAM), Reliable File Transfer (RFT), and Information Services (Index). All
  the Java clients to these services run on both Windows and Unix. The WSRF GRAM
  service requires infrastructure that only runs on Unix systems. </p>
<p> Therefore, if you are new to the toolkit and want to experiment with all
  of the components, you may want to use a Unix system. If you are interested
  in the Windows development, you may restrict yourself to the Java-based software. </p>
<h2><a name="supportsoftware"></a>3 Software Prerequisites </h2>
<h3><a name="reqsoftware"></a>3.1 Required software</h3>
<ul>
  <li>Globus Toolkit installer, from <a href="http://www-unix.globus.org/toolkit/downloads/development/">Globus
      Toolkit development download page</a></li>
  <li>JDK 1.4.2+ from <a href="java.sun.com">Sun</a> or <a href="
www.ibm.com/developerworks/java/">IBM</a>.</li>
  <li><a href="http://jakarta.apache.org/ant">Ant 1.5+</a>. Do not use the ant
    distributed with Fedora Core 2.</li>
  <li>C compiler. If <a href="http://gcc.gnu.org">gcc</a>, avoid version 3.2.
    3.2.1 and 2.95.x are okay.</li>
  <li><a href="http://www.gnu.org/software/tar/tar.html">GNU tar</a></li>
  <li>JDBC compliant database. For instance, <a
    href="http://www.postgresql.org">postgres</a> 7.1+</li>
  <li>gpt-3.2autotools2004 (shipped with the installers, but required if building
    standalone GPT bundles/packages)</li>
</ul>
<h3><a name="optsoftware"></a>3.2 Optional software</h3>
<ul>
  <li><a href="http://www.iodbc.org/">IODBC</a> (for RLS)</li>
  <li><a href="http://jakarta.apache.org/tomcat/">Tomcat</a> (for WSRF container)</li>
  <li><a href="http://junit.sourceforge.net/">junit</a> (for java unit tests)</li>
</ul>
<h3><a name="platformnotes"></a>3.3 Platform notes</h3>
<p>The <a href="platforms.html">platform notes page</a> contains more in-depth
  information about building Globus on certain platforms.</p>
<h2><a name="installinggt"></a>4 Installing GT 4.0 </h2>
<ol>
  <li>First, <a href="link-to-downloads-page">download</a> the required software. </li>
  <li>Be aware that Apache Ant will use the Java referred to by JAVA_HOME, <strong>not</strong> necessarily
    the first Java executable on your PATH. Be sure to set JAVA_HOME to the top-level
    directory of your Java installation before installing. </li>
  <li>If you want to build RLS, set GLOBUS_IODBC_PATH to point to the directory
    containing the IODBC driver. If you do not, the build of RLS will be skipped.
    You may finish the installation of RLS separately from the main build.</li>
  <li>Create a user named "globus". This non-privileged user will be used to
    perform administrative tasks such as starting and stopping the container,
    deploying services, etc. Make sure this account has read and write permissions
    in the $GLOBUS_LOCATION directory. </li>
  <li>As the globus user, run:
      <pre>globus$ export GLOBUS_LOCATION=/usr/local/globus-3.9.4
globus$ ./install-wsrf $GLOBUS_LOCATION</pre>
  </li>
  <li>You may replace <code>/usr/local/globus-3.9.4</code> with whatever directory you wish
    to install to. </li>
</ol>
<p><strong>Important:</strong> If for some reason you do <strong>not</strong> create
  a user named "globus", be sure to run the installation as a <b>non-root</b> user.</p>
<h3>4.1 Optional extras</h3>
<p>The schedulers/ and tests/ subdirectories contain optional bundles of software. </p>
<h4>4.1.1 Schedulers bundles </h4>
<p>If you are installing on a machine that has the submission software for PBS,
  LSF, or Condor already installed, you may install the corresponding <code>schedulers/gt4-gram-<scheduler>-3.9-src_bundle.tar.gz</code>  file. To do this, run:</p>
<pre> $ export GLOBUS_LOCATION=/usr/local/globus-3.9.4<br> $GLOBUS_LOCATION/sbin/gpt-build schedulers/gt4-gram-3.9-src_bundle.tar.gz<br> $GLOBUS_LOCATION/sbin/gpt-postinstall</pre>
<h4>4.1.2 Test bundles </h4>
<p>If you want to install the test bundles, you will need to install Junit. Then
  you may run:</p>
<pre> $ export GLOBUS_LOCATION=/usr/local/globus-3.9.4<br> $GLOBUS_LOCATION/sbin/gpt-build tests/*.tar.gz<br> $GLOBUS_LOCATION/sbin/gpt-postinstall</pre>
<h2><a name="requiredconfig"></a>5 Basic configuration</h2>
<h3><a name="envvariable"></a>5.1 Set environment variables</h3>
<p>In order for the system to know the location of the Globus Toolkit commands
  you just installed, you must set an environment variable and source the <code>globus-user-env.sh</code> script. </p>
<ol>
  <li><a name="step1"></a>As globus, set <code>GLOBUS_LOCATION</code> to where you installed the
    Globus Toolkit. This will  be one of the following:  </li>
  <ul>
    <li><code>export GLOBUS_LOCATION=/path/to/install</code></li>
    <li><code>setenv
                  GLOBUS_LOCATION /path/to/install</code>. </li>
  </ul>
  <li><a name="step2"></a>Source <code>$GLOBUS_LOCATION/etc/globus-user-env.{sh,csh}</code> depending
    on shell. 
    <ul>
      <li>Use <code>.sh</code> for Bourne shell.</li>
      <li>Use <code>.csh</code> for C shell.</li>
    </ul>
  </li>
</ol>
<h3><span class="box-header"><a name="hostcert"></a>5.2 Obtain host certificates</span></h3>
<p>You must have X509 certificates to use the GT 4.0 software securely (referred
  to in this documentation as <em>host certificates</em>). For an overview of
  certificates for GSI (security) see <a
	      href="http://www.globus.org/security/config.html">GSI Configuration Information</a>.</p>
<p>Host certificates must be:</p>
<ul>
  <li>consist of the following two files: <code>hostcert.pem</code> and <code>hostkey.pem</code></li>
  <li>must be in the
      appropriate directory for secure services: <code>/etc/grid-security/certificates</code></li>
  <li>must be for
    a machine which has a consistent name in DNS; you should <strong>not</strong> run
    it on a computer using DHCP where a different name could be assigned to your
    computer. </li>
</ul>
<p>You have the following options:</p>
<h4>5.2.1 Request a certificate from an existing CA</h4>
<p>Your best option is to use an already existing CA. You may have access to
  one from the company you work for, or an organization you are affiliated with.
  Some universities provide certificates for their members and affiliates. Contact
  your support organization for details about how to acquire a certificate. You
  may find your CA listed in the <a
href="http://www.terena.nl/tech/task-forces/tf-aace/tacar/certs.html">TERENA
Repository</a>. </p>
<p>If you already have a CA, you will need to follow their configuration directions.
    If they include a CA setup package, follow the CAs instruction on how to
  install the setup package. If they do not, you will need to create an <code>/etc/grid-security/certificates</code> directory
    and include the CA cert and signing policy in that directory. See <a
	      href="http://www.globus.org/security/config.html#Configuring%20a%20Trusted%20CA">Configuring
  a Trusted CA</a> for more details. </p>
<p>This type of certificate is best for service deployment and Grid inter-operation. </p>
<h4>5.2.2 SimpleCA</h4>
<p>SimpleCA provides a wrapper around the OpenSSL CA functionality and is sufficient
  for simple Grid services. Alternatively, you can use OpenSSL's <code>CA.sh</code> command
  on its own. Instructions on how to use the SimpleCA can be found <a href="simpleca.html">here</a>.  </p>
<p>SimpleCA is suitable for testing or when a certificate authority is not available.</p>
<h4>5.2.3 Low-trust certificate</h4>
<p>Globus offers a low-trust certificate available at <a
href="http://gcs.globus.org:8080/gcs">http://gcs.globus.org:8080/gcs</a>. This
  option should only be used as a last resort because it does not fulfill some
  of the duties of a real Certificate Authority. </p>
<p>This type of certificate
    is best suited for short term testing. </p>
<h3><span class="box-header"><a name="perms"></a>5.3 Make the host credentials
    accessible by the container</span></h3>
<p>The host key (<code>/etc/grid-security/hostkey.pem</code>) is only readable
  to root. The container (hosting environment) will be running as a non-root
  user (probably the <code>globus</code> user) and in order to have a set of host credentials
  which are readable by the container, we need to copy the host certificate and
  key and change the ownership to the container user. </p>
<p><strong>Note:</strong> that this step assumes
    you have <a href="#hostcert">obtained a signed host certficate from your
    CA</a>.</p>
<p>As root, run:</p>
<pre> $ cd /etc/grid-security<br> $ cp hostkey.pem containerkey.pem<br> $ cp hostcert.pem containercert.pem<br> $ chown globus.globus containerkey.pem containercert.pem</pre>
<p>At this point the certificates in <code>/etc/grid-security</code> should look something
  like:</p>
<pre>rynge@ned-0:/etc/grid-security$ ls -l *.pem
-rw-r--r-- 1 globus globus 1785 Oct 14 14:47 containercert.pem
-r-------- 1 globus globus  887 Oct 14 14:47 containerkey.pem
-rw-r--r-- 1 root   root   1785 Oct 14 14:42 hostcert.pem
-r-------- 1 root   root    887 Sep 29 09:59 hostkey.pem </pre>
<h3><span class="box-header"><a name="authorization"></a>5.4 Add authorization
    (grid-mapfile) </span></h3>
<p>Add authorizations for users:</p>
<p>Create <code>/etc/grid-security/grid-mapfile</code> as root. </p>
<p>You need two pieces of information:</p>
<ul>
  <li> the subject name of a user</li>
  <li> the account name it should map to.</li>
</ul>
<p>The syntax is one line per user, with the certificate subject followed by
  the user account name. </p>
<p>Run <code>grid-cert-info</code> to get your subject name, and <code>whoami</code> to
  get the account name:</p>
<pre>bacon$ grid-cert-info -subject<br>  /O=Grid/OU=GlobusTest/OU=simpleCA-mayed.mcs.anl.gov/OU=mcs.anl.gov/CN=Charles Bacon<br>bacon$ whoami<br>bacon</pre>
<p>The corresponding line in the <code>grid-mapfile</code> should look like:</p>
<pre>&quot;/O=Grid/OU=GlobusTest/OU=simpleCA-mayed.mcs.anl.gov/OU=mcs.anl.gov/CN=Charles
  Bacon&quot; <i>bacon</i> </pre>
<p><strong>Note:</strong> The quotes around the subject name are <strong>important</strong>, because it contains
  spaces.</p>
<h3><span class="box-header"><a name="starting_container" id="starting_container"></a>5.5
    Start the Container </span></h3>
<p>Now we can start the container. As the globus user:</p>
<pre>$ cd $GLOBUS_LOCATION
$ ./bin/globus-start-container -p 8443</pre>
<p>You should get a list URLs to available services and the container log.</p>
<h3>5.6 Verify the basic installation </h3>
<p>To verify the installation at this point, we can query the container registry. </p>
<p>As a user listed in the grid-mapfile, get a proxy:</p>
<pre>$ export $GLOBUS_LOCATION=/usr/local/globus-3.9.4
$ . $GLOBUS_LOCATION/etc/globus-user-env.sh
$ grid-proxy-init
Your identity: /O=Grid/OU=GlobusTest/OU=simpleCA-mayed.mcs.anl.gov/OU=mcs.anl.gov/CN=Charles Bacon
Enter GRID pass phrase for this identity:
Creating proxy .................................. Done
Your proxy is valid until: Wed Jan 12 03:49:52 2005</pre>
<p>Then, query the registry:</p>
<pre>$ bin/wsrf-get-property \
   -s https://127.0.0.1:9000/wsrf/services/ContainerRegistryService \
   {http://docs.oasis-open.org/wsrf/2004/06/wsrf-WS-ServiceGroup-1.2-draft-01.xsd}Entry</pre>
<p>The result should be a XML blob lising the URLs which were displayed when
  the container was started.</p>
<!--
<h3><a name="optionalconfig"></a>Optional configuration </h3>
<p><font color="purple">[basic configurations for the components]</font></p>
<h2><a name="testing"></a>Verifying your installation </h2>
<p><font color="purple">[instructions for testing your installation]</font></p>
<h2><a name="maintenance"></a>Maintaining your installation</h2>
<p><font color="purple">[what happens beyond installation]</font></p>
-->
<h3>5.7 Figure out where to go from here</h3>
<p>At this point you have a basic Globus container running. Many of the more
  advanced services require further configuration before they can be used. You
  can find this information in the System Administrator's Guide for that component.
  Some of the major services you might want to configure are:</p>
<ul>
  <li><a href="../data/gridftp/admin/">GridFTP</a></li>
  <li><a href="../data/rft/admin/">RFT</a></li>
  <li><a href="../execution/wsgram/admin/">GRAM</a></li>
</ul>
<p>The following is a list of all System Administrator Guides by component:</p>
<ul>
  <li>Common Runtime Components
      <ul>
        <li><a href="../common/javawscore/admin/">Java WS Core</a></li>
        <li><a href="../common/cwscore/admin/">C WS Core</a></li>
        <li><a href="../common/xio/admin/">XIO</a></li>
      </ul>
  </li>
  <li>Security
      <ul>
        <li>WS A&amp;A
            <ul>
              <li><a href="../security/authzframe/admin/">Authorization Framework</a></li>
              <li><a href="../security/cas/admin/">CAS</a></li>
              <li><a href="../security/delegation/admin/">Delegation Service</a></li>
              <li><a href="../security/message/admin/">Message/Transport-level
                  Security</a></li>
            </ul>
        </li>
        <li>Credential Management
            <ul>
              <li> <a href="../security/myproxy/admin/">MyProxy</a></li>
              <li> <a href="../security/simpleca/admin/">SimpleCA</a></li>
            </ul>
        </li>
        <li> Utilities
            <ul>
              <li><a href="../security/openssh/admin/">GSI-OpenSSH</a> </li>
            </ul>
        </li>
        <li><a href="../security/prewsaa/admin/">Pre-WS A&amp;A</a> </li>
      </ul>
  </li>
  <li>Data Management
      <ul>
        <li><a href="../data/gridftp/admin/">GridFTP</a></li>
        <li><a href="../data/rft/admin/">RFT</a></li>
        <li><a href="../data/rls/admin/">RLS</a> </li>
      </ul>
  </li>
  <li>Information Services
      <ul>
        <li>WS MDS (MDS4)
            <ul>
              <li><a href="../info/index/admin/">Index Service</a></li>
              <li><a href="../info/trigger/admin/">Trigger Service</a></li>
              <li><a href="../info/aggregator/admin/">Aggregator framework</a></li>
            </ul>
        </li>
        <li><a href="../info/prewsmds/admin/">Pre-WS MDS (MDS2)</a></li>
      </ul>
  </li>
  <li>Execution Management
      <ul>
        <li><a href="../execution/wsgram/admin/">WS GRAM (GRAM4)</a></li>
        <li><a href="../execution/prewsgram/admin/">Pre-WS GRAM (GRAM2) </a></li>
      </ul>
  </li>
</ul>
<h2>6 Maintaining your installation</h2>
<p>[TODO]</p>
<h2><a name="troubleshooting"></a>7 Troubleshooting</h2>
<h3>org.oasis.wsrf.lifetime.ResourceUnknownFaultType</h3>
<p>This error can be seen on both the client side and on the server side.</p>
<p>Sometimes a container may emit an error message of the form:
  
<pre>
[Thread-3] ERROR container.ServiceThread [doFault:628] HTTP server fault
AxisFault
 faultCode: {http://schemas.xmlsoap.org/soap/envelope/}Server.generalException
 faultSubcode:
 faultString:
 faultActor:
 faultNode:
 faultDetail:
        {http://xml.apache.org/axis/}exceptionName:org.oasis.wsrf.lifetime.ResourceUnknownFaultType
        {http://xml.apache.org/axis/}hostname:myhost.isi.edu
</pre>
<p></p>
<p> This indicates that a client has attempted to access a resource that does
  not exist in the container. </p>
<p> This can occur harmlessly when a container running an index service is restarted,
  as each registrant attempts to renew its registration from the previous instance
  of the container. In this case, the error message is harmless. Registrations
  will be automatically recreated by the registration client when they detect
  this condition. </p>
<p> In other cases, it may be because an incorrect endpoint reference (EPR) is
  being used by a client. In general, the client causing the error will also
  output a similar ResourceUnknownFaultType error message. </p>
<p> On the client side, this error often occurs if the EPR given to the client
  is incorrect (for example, due to cut-n-paste error). </p>
<h2><a name="relateddocs"></a>8 Related Documents</h2>
<p>The following are links to each component's system administrator guides. They
  provide advanced administration information you may need in addition to this
  document: </p>
<ul>
  <li>Common Runtime Components
      <ul>
        <li><a href="../common/javawscore/admin/">Java WS Core</a></li>
        <li><a href="../common/cwscore/admin/">C WS Core</a></li>
        <li><a href="../common/xio/admin/">XIO</a></li>
      </ul>
  </li>
  <li>Security
      <ul>
        <li>WS A&amp;A
            <ul>
              <li><a href="../security/authzframe/admin/">Authorization Framework</a></li>
              <li><a href="../security/cas/admin/">CAS</a></li>
              <li><a href="../security/delegation/admin/">Delegation Service</a></li>
              <li><a href="../security/message/admin/">Message/Transport-level
                  Security</a></li>
            </ul>
        </li>
        <li>Credential Management
            <ul>
              <li> <a href="../security/myproxy/admin/">MyProxy</a></li>
              <li> <a href="../security/simpleca/admin/">SimpleCA</a></li>
            </ul>
        </li>
        <li> Utilities
            <ul>
              <li><a href="../security/openssh/admin/">GSI-OpenSSH</a> </li>
            </ul>
        </li>
        <li><a href="../security/prewsaa/admin/">Pre-WS A&amp;A</a> </li>
      </ul>
  </li>
  <li>Data Management
      <ul>
        <li><a href="../data/gridftp/admin/">GridFTP</a></li>
        <li><a href="../data/rft/admin/">RFT</a></li>
        <li><a href="../data/rls/admin/">RLS</a> </li>
      </ul>
  </li>
  <li>Information Services
      <ul>
        <li>WS MDS (MDS4)
            <ul>
              <li><a href="../info/index/admin/">Index Service</a></li>
              <li><a href="../info/trigger/admin/">Trigger Service</a></li>
              <li><a href="../info/aggregator/admin/">Aggregator framework</a></li>
            </ul>
        </li>
        <li><a href="../info/prewsmds/admin/">Pre-WS MDS (MDS2)</a></li>
      </ul>
  </li>
  <li>Execution Management
      <ul>
        <li><a href="../execution/wsgram/admin/">WS GRAM (GRAM4)</a></li>
        <li><a href="../execution/prewsgram/admin/">Pre-WS GRAM (GRAM2) </a></li>
      </ul>
  </li>
</ul>
<p>&nbsp;</p>

<?php include("/mcs/www-unix.globus.org/include/globus_footer.inc"); ?>
