<?xml version='1.0' encoding='UTF-8'?>
<title>GT4 Message &amp; Transport Level Security Admin Guide</title>
<titleabbrev>Admin Guide</titleabbrev>
<section id="s-message-admin-introduction">
  <title>Introduction</title>
  <para>This guide contains advanced configuration information for system administrators
  working with Message/Transport-level Security. It provides references to information
  on procedures typically performed by system administrators, including installing,
    configuring, deploying, and testing the installation.</para>
  <important>
    <simpara> This information is in addition to the basic Globus Toolkit prerequisite, 
      overview, installation, security configuration instructions in the <ulink url="../../admin/docbook/">GT 4.0 System Administrator's Guide</ulink>.  
      Read through this guide before continuing!</simpara>  
  </important>
  <para>The main administration issues for this component deal with configuring
credential related settings. There are multiple mechanisms for
doing this:</para>
  <itemizedlist>
    <listitem>
      <para>Security Descriptors
  <itemizedlist>
          <listitem>
            <simpara>Container Security Descriptor: This is the <emphasis>preferred</emphasis> mechanism.</simpara>
          </listitem>
          <listitem>
            <simpara>Service Security Descriptor</simpara>
          </listitem>
        </itemizedlist></para>
    </listitem>
    <listitem>
      <simpara>CoG properties</simpara>
    </listitem>
    <listitem>
      <simpara>Environment variables</simpara>
    </listitem>
    <listitem>
      <simpara>Relying on default behavior. The only default behaviors available concern the proxy file and trusted certificates locations.</simpara>
    </listitem>
  </itemizedlist>
  <para>More information on these mechanisms can be found in the <ulink url="../WS_AA_Message_Level_Public_Interfaces.html">public interface guide</ulink>.
</para>
</section>
<section id="s-message-admin-installing">
  <title>Building and Installing</title>
  <para>There is no content available at this time.</para>
</section>
<section id="s-message-admin-configuring">
  <title>Configuring </title>
&WS_AA_Message_Level_Interface_Config_Frag;
</section>
<section id="s-message-admin-deploying">
  <title>Deploying</title>
  <section>
    <title>Tomcat &amp; Transport Security</title>
    <para>To deploy into Tomcat with transport security if there are no previous secure 
or non-secure deployments in this Tomcat installation run:
</para>
    <screen>$ cd $GLOBUS_LOCATION
$ ant -f share/globus_wsrf_common/tomcat/tomcat.xml deploySecureTomcat -Dtomcat.dir=&lt;tomcat.dir&gt;</screen>
    <para>If you are looking at updating an existing Tomcat deployment you should run:
</para>
    <screen>$ cd $GLOBUS_LOCATION
$ ant -f share/globus_wsrf_common/tomcat/tomcat.xml redeploySecureTomcat -Dtomcat.dir=&lt;tomcat.dir&gt;</screen>
    <note>
      <para>Please note that doing both a non-secure and a secure deployment into the same Tomcat installation will result in a non-working deployment</para>
    </note>
    <para>In addition to the above deployment step you will also need to modify
the Tomcat <filename>&lt;tomcat_root&gt;/conf/server.xml</filename> configuration file. In
particular you will need to add the following configuration entries:
</para>
    <itemizedlist>
      <listitem>
        <para>Tomcat 4.1.x
    
    <orderedlist>
            <listitem>
              <para>Add a HTTPS Connector in the <emphasis>&lt;Service name=&quot;Tomcat-Standalone&quot;&gt;</emphasis> section and update the parameters
appropriately with your local configuration: 
<screen>&lt;Connector
  className=&quot;org.apache.catalina.connector.http.HttpConnector&quot;
  port=&quot;8443&quot; minProcessors=&quot;5&quot; maxProcessors=&quot;75&quot;
  enableLookups=&quot;true&quot; authenticate=&quot;true&quot;
  acceptCount=&quot;10&quot; debug=&quot;1&quot; scheme=&quot;https&quot; secure=&quot;true&quot;&gt;
    &lt;Factory
       className=&quot;org.globus.tomcat.catalina.net.HTTPSServerSocketFactory&quot;
       proxy=&quot;/path/to/proxy/file&quot;
       cert=&quot;/path/to/certificate/file&quot;
       key=&quot;/path/to/private/key/file&quot;
       cacertdir=&quot;/path/to/ca/certificates/directory&quot;/&gt;
&lt;/Connector&gt;</screen></para>
              <para>In the above the proxy, cert, key and cacertdir attributes are
optional. Furthermore, the proxy and the combination of cert and key attributes are
mutually exclusive.
</para>
            </listitem>
            <listitem>
              <para>Add a HTTPS Valve in the <emphasis>&lt;Engine name=&quot;Standalone&quot; ... &gt; </emphasis>section:
<screen>&lt;Valve className=&quot;org.globus.tomcat.catalina.valves.HTTPSValve&quot;/&gt;</screen></para>
            </listitem>
          </orderedlist>
  </para>
      </listitem>
      <listitem>
        <para>Tomcat 5.0.x
    
    <orderedlist>
            <listitem>
              <para>Add a HTTPS Connector in the <emphasis>&lt;Service name=&quot;Catalina&quot;&gt;</emphasis> section and update the parameters
appropriately with your local configuration: 
<screen>&lt;Connector
  className=&quot;org.globus.tomcat.coyote.net.HTTPSConnector&quot;
  port=&quot;8443&quot; maxThreads=&quot;150&quot; minSpareThreads=&quot;25&quot; maxSpareThreads=&quot;75&quot;
  enableLookups=&quot;false&quot; disableUploadTimeout=&quot;true&quot; 
  acceptCount=&quot;100&quot;
  debug=&quot;0&quot; scheme=&quot;https&quot;
  proxy=&quot;/path/to/proxy/file&quot;
  cert=&quot;/path/to/certificate/file&quot;
  key=&quot;/path/to/private/key/file&quot;
  cacertdir=&quot;/path/to/ca/certificates/directory&quot;/&gt;</screen></para>
              <para>In the above the proxy, cert, key and cacertdir attributes are
optional. Furthermore, the proxy and the combination of cert and key attributes are
mutually exclusive.
</para>
            </listitem>
            <listitem>
              <para>Add a HTTPS Valve in the <emphasis>&lt;Engine name=&quot;Catalina&quot; ... &gt; </emphasis>section:
<screen>&lt;Valve className=&quot;org.globus.tomcat.coyote.valves.HTTPSValve&quot;/&gt;</screen></para>
            </listitem>
          </orderedlist>
  </para>
      </listitem>
    </itemizedlist>
  </section>
</section>
<section id="s-message-admin-testing">
  <title>Testing</title>
  <para>There is no content available at this time.</para>
</section>
<section id="s-message-admin-security_considerations">
  <title>Security Considerations </title>
&WS_AA_Message_Level_Security_Considerations_Frag;
</section>
<section id="s-message-admin-troubleshooting">
  <title>Troubleshooting</title>
&Credential_Troubleshooting_Frag;
</section>
