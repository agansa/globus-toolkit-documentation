<title>GT4 Message Level Security Admin Guide</title>
<titleabbrev>Admin Guide</titleabbrev>
<section id="s-message-admin-introduction"><title>Introduction</title>
<para>This guide contains advanced configuration information for system administrators
  working with Message/Transport-level Security. It provides references to information
  on procedures typically performed by system administrators, including installation,
  configuring, deploying, and testing the installation.</para>
<para>This information is in addition to the basic installation instructions in
  the <ulink url="../../../admin/docbook/">GT 4.0 System Administrator's Guide</ulink>.</para>
<para>The main administration issues for this component deal with configuring
credential related settings. There are multiple mechanisms for
doing this:</para>
<itemizedlist>
  <listitem><para>Security Descriptors
  <itemizedlist>
    <listitem><simpara>Container Security Descriptor: This is the <emphasis>preferred</emphasis> mechanism.</simpara></listitem>
    <listitem><simpara>Service Security Descriptor</simpara></listitem>
  </itemizedlist>
  </para></listitem>
  <listitem><simpara>CoG properties</simpara></listitem>
  <listitem><simpara>Environment variables</simpara></listitem>
  <listitem><simpara>Relying on default behavior. The only default behaviors available
concern the proxy file and trusted certificates locations.</simpara></listitem>
</itemizedlist>
<para>More information on these mechanisms can be found in the <ulink
 url="../WS_AA_Message_Level_Public_Interfaces.html">public interface
  guide</ulink>.
</para>
</section>
<section id="s-message-admin-installing"><title>Building and Installing</title>
<para>[information about installing the component -
may link to Installation Guide]</para>
</section>
<section id="s-message-admin-configuring"><title>Configuring </title>
&WS_AA_Message_Level_Interface_Config_Frag;
</section>
<section id="s-message-admin-deploying"><title>Deploying</title>
<section><title>Tomcat &amp; Transport Security</title>
<para>
To deploy into Tomcat with transport security if there are no previous secure 
or non-secure deployments in this Tomcat installation run:
</para>
<screen>
 $ cd $GLOBUS_LOCATION
 $ ant -f share/globus_wsrf_common/tomcat/tomcat.xml deploySecureTomcat -Dtomcat.dir=&lt;tomcat.dir&gt;</screen>
<para>
If you are looking at updating a existing Tomcat deployment you should run:
</para>
<screen>
 $ cd $GLOBUS_LOCATION
 $ ant -f share/globus_wsrf_common/tomcat/tomcat.xml redeploySecureTomcat -Dtomcat.dir=&lt;tomcat.dir&gt;</screen>
	<note><para>Please note that doing both a non-secure and a secure deployment into the same Tomcat installation will result in a non-working deployment</para></note>
<para>
In addition to the above deployment step you will also need to modify
the Tomcat <filename>&lt;tomcat_root&gt;/conf/server.xml</filename> configuration file. In
particular you will need to add the following configuration entries:
</para>
<itemizedlist>
  <listitem><para>Tomcat 4.1.x
    
    <orderedlist>
      <listitem><para>Add a HTTPS Connector in the <emphasis>&lt;Service
name="Tomcat-Standalone"&gt;</emphasis> section and update the parameters
appropriately with your local configuration: 
<screen>
&lt;Connector
  className="org.apache.catalina.connector.http.HttpConnector"
  port="8443" minProcessors="5" maxProcessors="75"
  enableLookups="true" authenticate="true"
  acceptCount="10" debug="1" scheme="https" secure="true"&gt;
    &lt;Factory
       className="org.globus.tomcat.catalina.net.HTTPSServerSocketFactory"
       proxy="/path/to/proxy/file"
       cert="/path/to/certificate/file"
       key="/path/to/private/key/file"
       cacertdir="/path/to/ca/certificates/directory"/&gt;
&lt;/Connector&gt;</screen>
</para>
<para>
In the above the proxy, cert, key and cacertdir attributes are
optional. Furthermore, proxy and the combination of cert and key are
mutually exclusive.
</para>
      </listitem>
      <listitem><para>Add a HTTPS Valve in the <emphasis>&lt;Engine name="Standalone" ... &gt; </emphasis>section:
<screen>
 &lt;Valve className="org.globus.tomcat.catalina.valves.HTTPSValve"/&gt;</screen>
      </para></listitem>
    </orderedlist>
  </para></listitem>
  <listitem><para>Tomcat 5.0.x
    
    <orderedlist>
      <listitem><para>Add a HTTPS Connector in the <emphasis>&lt;Service
name="Catalina"&gt;</emphasis> section and update the parameters
appropriately with your local configuration: 
<screen>
&lt;Connector
  className="org.globus.tomcat.coyote.net.HTTPSConnector"
  port="8443" maxThreads="150" minSpareThreads="25" maxSpareThreads="75"
  enableLookups="false" disableUploadTimeout="true" 
  acceptCount="100"
  debug="0" scheme="https"
  proxy="/path/to/proxy/file"
  cert="/path/to/certificate/file"
  key="/path/to/private/key/file"
  cacertdir="/path/to/ca/certificates/directory"/&gt;</screen>
</para>
<para>
In the above the proxy, cert, key and cacertdir attributes are
optional. Furthermore, proxy and the combination of cert and key are
mutually exclusive.
</para>
      </listitem>
      <listitem><para>Add a HTTPS Valve in the <emphasis>&lt;Engine name="Catalina" ... &gt; </emphasis>section:
<screen>
&lt;Valve className="org.globus.tomcat.coyote.valves.HTTPSValve"/&gt;
</screen>
      </para></listitem>
    </orderedlist>
  </para></listitem>
</itemizedlist>
</section>
</section>
<section id="s-message-admin-testing"><title>Testing</title>
<para>[procedures for how to test the configuration.
must include examples of the tests ]</para>
</section>
<section id="s-message-admin-security_considerations"><title>Security Considerations </title>
&WS_AA_Message_Level_Security_Considerations_Frag;
  </section>
  <section id="s-message-admin-troubleshooting"><title>Troubleshooting</title>
&Credential_Troubleshooting_Frag;
</section>
